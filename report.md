<div>
<img src='https://my.onlinechiro.com/0023379/storage/app/media/512x512bb.png' align="right" height="139" />
</div>

# Проект: Отслеживание и сортировка мусора на конвейере

## Введение

* **Описание задачи:**  IT-компания Renue из Екатеринбурга, разрабатывает высоконагруженные и отказоустойчивые решения для крупных российских заказчиков, для бизнеса и государства. Необходимо разработать решение для отслеживания и сортировки мусора на конвейере – выделять пластиковые бутылки в общем потоке предметов, которая будет иметь максимально высокую метрику MOTA (Multiple Object Tracking Accuracy).
* **Цель проекта:**  Целью данного проекта является модель, которая выдает координаты центра обнаруженных пластиковых бутылок для каждого кадра для передачи манипулятору. Необходимо учесть, чтобы скорость обработки была не более 100 мс.
* **Датасет:** Предобученная модель детекции пластиковых бутылок и код для ее запуска. Датасет (изображения + разметка) в нескольких форматах: MOT, COCO, CVAT. Примеры видеозаписей работы конвейера.

## Методы
 При работе над проектом мы сразу выбрали *библиотеку Ultralytics*, потому что она обеспечивает встроенную поддержку различных наборов данных, что облегчает начало работы с высококачественными данными (видео) и это сэкономило нам много времени и сил на начальных этапах работы над проектом. Так же это библиотека имеет встроенные настройки аугментации прямо в своей функции обучения модели. *Библиотека Ultralytics* упрощает процесс обучения. Эта библиотека автоматически справляются с корректировкой веса, обратным распространением и проверкой. Она также предлагает инструменты для мониторинга прогресса и легкой настройки гиперпараметров. После обучения сохранили модель и ее веса.

 * **Аннотирование данных** — это процесс маркировки данных для передачи знаний модели.В нашем проекте мы использовали следующие типы аннотирование данных:
     * **1.Обнаружение объектов (Object detection "box")** - рисуешь ограничительные рамки вокруг каждого объекта на изображении и метишь каждую рамку.
     * **2.Сегментация изображения (Segmentation)** метишь каждый пиксель на изображении в соответствии с объектом, к которому он относится, создав подробные границы объектов.
 
Аннотирование данных можно проводить в ручную, но это очень долгий и сложный процесс, поэтому мы решили использувать автоматический инструмент - **Annotator**.

Чтобы лучше понять свои данные, мы использовали такие инструменты, как Matplotlib, чтобы визуализировать изображения и проанализировать их распределение и характеристики. Визуализация данных помогает выявить закономерности, аномалии и эффективность наших методов дополнения. 

* **Оценка качества:**  Для оценки качества моделей были использованы следующие метрики:
* MOTA (Multiple Object Tracking Accuracy)

## Результаты

* **Таблицы с результатами:**

| Модель+Tracking                      | Accuracy | MOT  | MOTA |Time local*|Time Kaggle|Time Google Colab|
|-----------------------------|------------|-----------|-----------|-------------|-----|------|
| базовая  | 0.9682     | 0.9039    | 0.9167    | 0.9482      |
| YOLO обученная заказчиком | 0.9242     | 0.8572    | 0.8657    | 0.9639     |
| YOLO обученная     | 0.3320     | 0.2687    | 0.2805    | 0.8983     |
| SORT (Simple Online and Realtime Tracking) (без предобработки)          | 0.5686     | 0.4736    | 0.4879    |         |
| SORT (Simple Online and Realtime Tracking) (с предобработкой)          | 0.8036     | 0.6804    | 0.6968    |         |
| Deep SORT (с предобработкой)               | 0.8619     | 0.7321    | 0.7469    |         |
| Deep SORT (с предобработкой)              | 0.4355     | 0.3589    | 0.3710    |        |
| ByteTrack (без предобработки)                   | 0.8888     | 0.7894    | 0.8018    |        |
| ByteTrack (с предобработкой)                   | 0.8709     | 0.7615    | 0.7734    |        |

* *Для определения *Time local* использовалось железо:
    * Процессор Intel® Core™ i7-12650H
    * Оперативная память 16Gb RAM
    * Видео-карта RTX 4060 mobile

* **Анализ результатов:**

* **Все модели показали.** При этом скорость работы этих моделей значительно ниже, но так как для данной задачи скорость работы всё ранво остаётся в пределах нормы, то выбор лучшей модели будет осуществляться среди моделей SentenceTransformer.
* Модель 
* Предобработка .
* Модели .
* Модели, специально обученные .
* Метрики .

## Обсуждение

* **Преимущества и недостатки разных моделей+tracking:**

  * **базовая:**
      * **Преимущества:**  Простота,  быстрота,  небольшие требования к ресурсам.
      * **Недостатки:**  Низкое качество по сравнению с более сложными моделями.
  * **YOLO обученная:**
      * **Преимущества:**  
      * **Недостатки:**   
  * **YOLO+SORT:**
      * **Преимущества:**   
      * **Недостатки:**  
  * **YOLO+Deep SORT:**
      * **Преимущества:**  
      * **Недостатки:**  
  * **YOLO+ByteTrack:**
      * **Преимущества:**  
      * **Недостатки:**  

  
## Выводы

* **Выбор модели для отслеживания и сортировка мусора на конвейере:**  
* **Основные выводы:**  В ходе проекта были исследованы различные подходы.  Результаты показали,  что библиотека Ultralytics с моделью YOLO хорошо себя показала.
* **Дальнейшее развитие:**  
   * **Использование других моделей:**  Можно попробовать использовать другие модели,  такие как:
       * Региональные сверточные нейронные сети - **Mask R-CNN**
       * Однократный мультибоксный детектор - **SSD-накопитель**
       * Трансформеры зрения - **Swin Transformer**
       * Эффективная сеть EfficientNet  - **Detectron2**
  
     
## Ссылки
[**Дукументация YOLO**](https://docs.ultralytics.com)
<div>
<img src='https://lipfarm.ru/upload/iblock/370/3zapmnl9nk76cg49m40tiih6euzbamsk.jpg' align="right" height="139" />
</div>

[**Лицензия**](https://github.com/FedorSafonov/computer-vision-for-conveyor-belt/blob/main/LICENSE)
